function Layzr(t){this._lastScroll=0,this._ticking=!1,t=t||{},this._optionsContainer=document.querySelector(t.container)||window,this._optionsSelector=t.selector||"[data-layzr]",this._optionsAttr=t.attr||"data-layzr",this._optionsAttrSrcSet=t.attrSrcSet||"data-layzr-srcset",this._optionsAttrRetina=t.retinaAttr||"data-layzr-retina",this._optionsAttrBg=t.bgAttr||"data-layzr-bg",this._optionsAttrHidden=t.hiddenAttr||"data-layzr-hidden",this._optionsThreshold=t.threshold||0,this._optionsBefore=t.before||null,this._optionsAfter=t.after||null,this._optionsCallback=t.callback||null,this._retina=window.devicePixelRatio>1,this._srcAttr=this._retina?this._optionsAttrRetina:this._optionsAttr,this._nodes=document.querySelectorAll(this._optionsSelector),this._handlerBind=this._requestScroll.bind(this),this._create()}!function(){for(var t=0,i=["ms","moz","webkit","o"],e=0;e<i.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[i[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[e]+"CancelAnimationFrame"]||window[i[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(i){var e=(new Date).getTime(),n=Math.max(0,16-(e-t)),o=window.setTimeout(function(){i(e+n)},n);return t=e+n,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),Layzr.prototype._requestScroll=function(){this._optionsContainer===window?this._lastScroll=window.pageYOffset:this._lastScroll=this._optionsContainer.scrollTop+this._getOffset(this._optionsContainer),this._requestTick()},Layzr.prototype._requestTick=function(){this._ticking||(requestAnimationFrame(this.update.bind(this)),this._ticking=!0)},Layzr.prototype._getOffset=function(t){if(t.hasAttribute("data-src"))var i=t.getAttribute("data-src"),e=i.substring(i.lastIndexOf(".")+1);return"png"==e&&t.parentNode.classList.add("layzr-bg-transparent"),t.getBoundingClientRect().top+window.pageYOffset},Layzr.prototype._getContainerHeight=function(){return this._optionsContainer.innerHeight||this._optionsContainer.offsetHeight},Layzr.prototype._create=function(){this._handlerBind(),this._optionsContainer.addEventListener("scroll",this._handlerBind,!1),this._optionsContainer.addEventListener("resize",this._handlerBind,!1)},Layzr.prototype._destroy=function(){this._optionsContainer.removeEventListener("scroll",this._handlerBind,!1),this._optionsContainer.removeEventListener("resize",this._handlerBind,!1)},Layzr.prototype._inViewport=function(t){var i=this._lastScroll,e=i+this._getContainerHeight(),n=this._getOffset(t),o=n+this._getContainerHeight(),r=this._optionsThreshold/100*window.innerHeight;return o>=i-r&&e+r>=n&&!t.hasAttribute(this._optionsAttrHidden)},Layzr.prototype.inView=function(t){var i=window;obj=this;var e=dtGlobals.winScrollTop,n=this._optionsThreshold/100*window.innerHeight,o=dtGlobals.winScrollTop+i.innerHeight,r=this._getOffset(t)+n;return o>=r&&r>=e},Layzr.prototype._reveal=function(t){var i=t.getAttribute(this._srcAttr)||t.getAttribute(this._optionsAttr),e=this;if("function"==typeof this._optionsCallback){t.addEventListener?t.addEventListener("load",function(){e._optionsCallback.call(t)}):t.attachEvent("onload",function(){e._optionsCallback.call(t)})}"function"==typeof this._optionsBefore&&this._optionsBefore.call(t),t.hasAttribute(this._optionsAttrBg)?t.style.backgroundImage="url("+i+")":(i&&t.setAttribute("src",i),t.hasAttribute(this._optionsAttrSrcSet)&&t.setAttribute("srcset",t.getAttribute(this._optionsAttrSrcSet))),"function"==typeof this._optionsAfter&&this._optionsAfter.call(t),t.removeAttribute(this._optionsAttr),t.removeAttribute(this._optionsAttrSrcSet),t.removeAttribute(this._optionsAttrRetina),t.removeAttribute(this._optionsAttrBg),t.removeAttribute(this._optionsAttrHidden)},Layzr.prototype.updateSelector=function(){this._nodes=document.querySelectorAll(this._optionsSelector)},Layzr.prototype.update=function(){for(var t=this._nodes.length,i=0;t>i;i++){var e=this._nodes[i];(e.hasAttribute(this._optionsAttr)||e.hasAttribute(this._optionsAttrSrcSet)||e.hasAttribute(this._optionsAttrRetina))&&this._inViewport(e)&&this._reveal(e)}this._ticking=!1};